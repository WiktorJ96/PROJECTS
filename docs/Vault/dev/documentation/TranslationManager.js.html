<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>TranslationManager.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ChartManager.html">ChartManager</a><ul class='methods'><li data-type='method'><a href="ChartManager.html#getResponsiveFontSize">getResponsiveFontSize</a></li><li data-type='method'><a href="ChartManager.html#getResponsivePadding">getResponsivePadding</a></li><li data-type='method'><a href="ChartManager.html#getResponsiveTicksLimit">getResponsiveTicksLimit</a></li><li data-type='method'><a href="ChartManager.html#initializeChart">initializeChart</a></li><li data-type='method'><a href="ChartManager.html#setTheme">setTheme</a></li><li data-type='method'><a href="ChartManager.html#setupLanguageChangeListener">setupLanguageChangeListener</a></li><li data-type='method'><a href="ChartManager.html#setupResizeListener">setupResizeListener</a></li><li data-type='method'><a href="ChartManager.html#updateChart">updateChart</a></li><li data-type='method'><a href="ChartManager.html#updateLanguage">updateLanguage</a></li><li data-type='method'><a href="ChartManager.html#updateResponsiveSettings">updateResponsiveSettings</a></li></ul></li><li><a href="DataBaseManager.html">DataBaseManager</a><ul class='methods'><li data-type='method'><a href="DataBaseManager.html#addTransaction">addTransaction</a></li><li data-type='method'><a href="DataBaseManager.html#checkServerAvailability">checkServerAvailability</a></li><li data-type='method'><a href="DataBaseManager.html#deleteAllTransactions">deleteAllTransactions</a></li><li data-type='method'><a href="DataBaseManager.html#deleteTransaction">deleteTransaction</a></li><li data-type='method'><a href="DataBaseManager.html#getTransactions">getTransactions</a></li><li data-type='method'><a href="DataBaseManager.html#getUnsyncedTransactions">getUnsyncedTransactions</a></li><li data-type='method'><a href="DataBaseManager.html#markTransactionAsSynced">markTransactionAsSynced</a></li><li data-type='method'><a href="DataBaseManager.html#startServerAvailabilityChecks">startServerAvailabilityChecks</a></li><li data-type='method'><a href="DataBaseManager.html#syncTransactions">syncTransactions</a></li></ul></li><li><a href="IndexedDBManager.html">IndexedDBManager</a><ul class='methods'><li data-type='method'><a href="IndexedDBManager.html#addTransaction">addTransaction</a></li><li data-type='method'><a href="IndexedDBManager.html#deleteAllTransactions">deleteAllTransactions</a></li><li data-type='method'><a href="IndexedDBManager.html#deleteTransaction">deleteTransaction</a></li><li data-type='method'><a href="IndexedDBManager.html#getDB">getDB</a></li><li data-type='method'><a href="IndexedDBManager.html#getTransactions">getTransactions</a></li><li data-type='method'><a href="IndexedDBManager.html#getUnsyncedTransactions">getUnsyncedTransactions</a></li><li data-type='method'><a href="IndexedDBManager.html#initializeDB">initializeDB</a></li><li data-type='method'><a href="IndexedDBManager.html#markTransactionAsSynced">markTransactionAsSynced</a></li></ul></li><li><a href="MongoDBManager.html">MongoDBManager</a><ul class='methods'><li data-type='method'><a href="MongoDBManager.html#addTransaction">addTransaction</a></li><li data-type='method'><a href="MongoDBManager.html#deleteAllTransactions">deleteAllTransactions</a></li><li data-type='method'><a href="MongoDBManager.html#deleteTransaction">deleteTransaction</a></li><li data-type='method'><a href="MongoDBManager.html#getTransactions">getTransactions</a></li></ul></li><li><a href="PWAManager.html">PWAManager</a><ul class='methods'><li data-type='method'><a href="PWAManager.html#hideInstallButton">hideInstallButton</a></li><li data-type='method'><a href="PWAManager.html#init">init</a></li><li data-type='method'><a href="PWAManager.html#installPWA">installPWA</a></li><li data-type='method'><a href="PWAManager.html#showIOSInstallInstructions">showIOSInstallInstructions</a></li><li data-type='method'><a href="PWAManager.html#showInstallButton">showInstallButton</a></li></ul></li><li><a href="ThemeManager.html">ThemeManager</a><ul class='methods'><li data-type='method'><a href="ThemeManager.html#addEventListeners">addEventListeners</a></li><li data-type='method'><a href="ThemeManager.html#initTheme">initTheme</a></li><li data-type='method'><a href="ThemeManager.html#setTheme">setTheme</a></li><li data-type='method'><a href="ThemeManager.html#toggleTheme">toggleTheme</a></li><li data-type='method'><a href="ThemeManager.html#updateToggleButton">updateToggleButton</a></li></ul></li><li><a href="TransactionManager.html">TransactionManager</a><ul class='methods'><li data-type='method'><a href="TransactionManager.html#createNewTransaction">createNewTransaction</a></li><li data-type='method'><a href="TransactionManager.html#deleteAllTransactions">deleteAllTransactions</a></li><li data-type='method'><a href="TransactionManager.html#deleteTransaction">deleteTransaction</a></li><li data-type='method'><a href="TransactionManager.html#getCurrentBalance">getCurrentBalance</a></li><li data-type='method'><a href="TransactionManager.html#loadTransactions">loadTransactions</a></li><li data-type='method'><a href="TransactionManager.html#syncTransactions">syncTransactions</a></li><li data-type='method'><a href="TransactionManager.html#updateCurrencyBasedOnLanguage">updateCurrencyBasedOnLanguage</a></li></ul></li><li><a href="TranslationManager.html">TranslationManager</a><ul class='methods'><li data-type='method'><a href="TranslationManager.html#addLanguageListeners">addLanguageListeners</a></li><li data-type='method'><a href="TranslationManager.html#fetchTranslations">fetchTranslations</a></li><li data-type='method'><a href="TranslationManager.html#loadPreferredLanguage">loadPreferredLanguage</a></li><li data-type='method'><a href="TranslationManager.html#loadTranslations">loadTranslations</a></li><li data-type='method'><a href="TranslationManager.html#setLanguage">setLanguage</a></li><li data-type='method'><a href="TranslationManager.html#translatePage">translatePage</a></li><li data-type='method'><a href="TranslationManager.html#updateLanguageButtons">updateLanguageButtons</a></li></ul></li><li><a href="UIManager.html">UIManager</a><ul class='methods'><li data-type='method'><a href="UIManager.html#addTransactionToDOM">addTransactionToDOM</a></li><li data-type='method'><a href="UIManager.html#clearInputs">clearInputs</a></li><li data-type='method'><a href="UIManager.html#clearTransactionsDisplay">clearTransactionsDisplay</a></li><li data-type='method'><a href="UIManager.html#closePanel">closePanel</a></li><li data-type='method'><a href="UIManager.html#confirmDeleteTransaction">confirmDeleteTransaction</a></li><li data-type='method'><a href="UIManager.html#deleteAllTransactions">deleteAllTransactions</a></li><li data-type='method'><a href="UIManager.html#deleteTransaction">deleteTransaction</a></li><li data-type='method'><a href="UIManager.html#getCategoryIcon">getCategoryIcon</a></li><li data-type='method'><a href="UIManager.html#handleTransactionTypeChange">handleTransactionTypeChange</a></li><li data-type='method'><a href="UIManager.html#hideDeleteAllModal">hideDeleteAllModal</a></li><li data-type='method'><a href="UIManager.html#hideDeleteTransactionModal">hideDeleteTransactionModal</a></li><li data-type='method'><a href="UIManager.html#initializeElements">initializeElements</a></li><li data-type='method'><a href="UIManager.html#initializeEventListeners">initializeEventListeners</a></li><li data-type='method'><a href="UIManager.html#saveTransaction">saveTransaction</a></li><li data-type='method'><a href="UIManager.html#setLanguage">setLanguage</a></li><li data-type='method'><a href="UIManager.html#showDeleteAllModal">showDeleteAllModal</a></li><li data-type='method'><a href="UIManager.html#showDeleteTransactionModal">showDeleteTransactionModal</a></li><li data-type='method'><a href="UIManager.html#showPanel">showPanel</a></li><li data-type='method'><a href="UIManager.html#updateBalance">updateBalance</a></li><li data-type='method'><a href="UIManager.html#updateLanguage">updateLanguage</a></li><li data-type='method'><a href="UIManager.html#updateTransactionsDisplay">updateTransactionsDisplay</a></li></ul></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">TranslationManager.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Manages translations for the application.
 * Handles fetching, applying translations, and language switching.
 * Updates the UI dynamically based on the selected language.
 */
class TranslationManager {
  /**
   * Creates an instance of TranslationManager.
   * Initializes translations, sets the current language, and adds event listeners.
   *
   * @constructor
   */
  constructor() {
    /**
     * Stores the translations for different languages.
     * @type {Object}
     * @property {Object} pl - Translations for Polish.
     * @property {Object} en - Translations for English.
     */
    this.translations = {
      pl: {},
      en: {},
    };

    /**
     * The currently selected language.
     * Defaults to 'pl' if no preference is stored in localStorage.
     * @type {string}
     */
    this.currentLanguage = localStorage.getItem("preferredLanguage") || "pl";

    // Initialize language buttons and load the preferred language
    this.addLanguageListeners();
    this.loadPreferredLanguage();
  }

  /**
   * Fetches translations from a JSON file based on the given language.
   * The file path is determined dynamically based on the current page.
   *
   * @param {string} lang - The language code ('pl' or 'en').
   * @returns {Promise&lt;Object>} Resolves to the translations object.
   */
  async fetchTranslations(lang) {
    const page = document.body.getAttribute("data-page");
    const path = `./translates/${page}-${lang}.json`;

    try {
      const response = await fetch(path);
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      return await response.json();
    } catch (error) {
      console.error(`Error loading translations for ${lang}:`, error);
      return {};
    }
  }

  /**
   * Loads translations for the specified language and updates the page UI.
   *
   * @param {string} lang - The language code ('pl' or 'en').
   * @returns {Promise&lt;void>} Resolves when translations are applied.
   */
  async loadTranslations(lang) {
    const data = await this.fetchTranslations(lang);
    this.translations[lang] = data;
    this.translatePage(lang);
  }

  /**
   * Sets the application language, updates UI, and stores the preference in localStorage.
   *
   * @param {string} lang - The language code ('pl' or 'en').
   */
  setLanguage(lang) {
    localStorage.setItem("preferredLanguage", lang);
    this.currentLanguage = lang;
    this.loadTranslations(lang);
    this.updateLanguageButtons(lang);

    // Dispatch a custom event to notify other parts of the app
    document.dispatchEvent(
      new CustomEvent("languageChanged", { detail: { language: lang } })
    );
  }

  /**
   * Loads the preferred language from localStorage and applies its translations.
   */
  loadPreferredLanguage() {
    this.loadTranslations(this.currentLanguage);
    this.updateLanguageButtons(this.currentLanguage);
  }

  /**
   * Translates all elements on the page based on the selected language.
   *
   * @param {string} lang - The language code ('pl' or 'en').
   */
  translatePage(lang) {
    // Translate elements with `data-lang-key`
    document.querySelectorAll("[data-lang-key]").forEach((element) => {
      const key = element.getAttribute("data-lang-key");
      if (this.translations[lang][key]) {
        element.innerHTML = this.translations[lang][key];
      } else {
        console.warn(`Missing translation for key: ${key}`);
        element.innerHTML = `[${key}]`;
      }
    });

    // Translate elements with `data-placeholder-key`
    document.querySelectorAll("[data-placeholder-key]").forEach((element) => {
      const key = element.getAttribute("data-placeholder-key");
      if (this.translations[lang][key]) {
        element.placeholder = this.translations[lang][key];
      } else {
        console.warn(`Missing placeholder translation for key: ${key}`);
      }
    });

    // Translate options in select elements
    document.querySelectorAll("select option").forEach((option) => {
      const key = option.getAttribute("data-lang-key");
      if (this.translations[lang][key]) {
        option.textContent = this.translations[lang][key];
      } else if (key) {
        console.warn(`Missing option translation for key: ${key}`);
        option.textContent = `[${key}]`;
      }
    });

    // Update the language attribute for accessibility
    document.documentElement.lang = lang;
  }

  /**
   * Adds event listeners for language selection buttons.
   */
  addLanguageListeners() {
    const langPl = document.getElementById("lang-pl");
    const langEn = document.getElementById("lang-en");

    if (langPl) {
      langPl.addEventListener("click", () => this.setLanguage("pl"));
    } else {
      console.warn("Polish language button not found");
    }

    if (langEn) {
      langEn.addEventListener("click", () => this.setLanguage("en"));
    } else {
      console.warn("English language button not found");
    }
  }

  /**
   * Updates the active state of language selection buttons.
   *
   * @param {string} lang - The currently selected language ('pl' or 'en').
   */
  updateLanguageButtons(lang) {
    const langPl = document.getElementById("lang-pl");
    const langEn = document.getElementById("lang-en");

    if (langPl) langPl.classList.remove("active");
    if (langEn) langEn.classList.remove("active");

    if (lang === "pl" &amp;&amp; langPl) {
      langPl.classList.add("active");
    } else if (lang === "en" &amp;&amp; langEn) {
      langEn.classList.add("active");
    }
  }
}

export default TranslationManager;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Tue Nov 26 2024 01:40:08 GMT+0100 (czas Å›rodkowoeuropejski standardowy) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
